============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\sanal\AppData\Local\Programs\Python\Python311\python.exe
cachedir: .pytest_cache
PySide6 6.7.2 -- Qt runtime 6.7.2 -- Qt compiled 6.7.2
rootdir: D:\github\webos
configfile: pyproject.toml
plugins: anyio-4.3.0, asyncio-1.2.0, mock-3.15.0, qt-4.5.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 5 items

tests/modules/dam/test_backend_gaps.py::test_ai_processors_registration Windows fatal exception: code 0xc0000139

Current thread 0x00004504 (most recent call first):
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\ctypes\__init__.py", line 376 in __init__
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\_ops.py", line 1392 in load_library
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\extension.py", line 34 in <module>
  File "<frozen importlib._bootstrap>", line 241 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 940 in exec_module
  File "<frozen importlib._bootstrap>", line 690 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1147 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1176 in _find_and_load
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\__init__.py", line 9 in <module>
  File "<frozen importlib._bootstrap>", line 241 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 940 in exec_module
  File "<frozen importlib._bootstrap>", line 690 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1147 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1176 in _find_and_load
  File "D:\github\webos\src\modules\dam\processors\structural_processor.py", line 14 in __init__
  File "D:\github\webos\src\modules\dam\hooks.py", line 127 in register_services
  File "D:\github\webos\tests\modules\dam\test_backend_gaps.py", line 40 in registry_setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pytest_asyncio\plugin.py", line 314 in setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 84 in _run
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1936 in _run_once
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 608 in run_forever
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321 in run_forever
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 641 in run_until_complete
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118 in run
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pytest_asyncio\plugin.py", line 318 in _asyncgen_fixture_wrapper
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py", line 930 in call_fixture_func
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py", line 1196 in pytest_fixture_setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py", line 121 in _multicall
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py", line 512 in __call__
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py", line 1128 in execute
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py", line 640 in _get_active_fixturedef
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py", line 549 in getfixturevalue
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py", line 720 in _fillfixtures
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\python.py", line 1674 in setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pytest_asyncio\plugin.py", line 463 in setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 514 in setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 164 in pytest_runtest_setup
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py", line 121 in _multicall
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py", line 512 in __call__
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 246 in <lambda>
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 344 in from_call
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 245 in call_and_report
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 130 in runtestprotocol
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\runner.py", line 117 in pytest_runtest_protocol
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py", line 121 in _multicall
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py", line 512 in __call__
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\main.py", line 367 in pytest_runtestloop
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py", line 121 in _multicall
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py", line 512 in __call__
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\main.py", line 343 in _main
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\main.py", line 289 in wrap_session
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\main.py", line 336 in pytest_cmdline_main
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py", line 121 in _multicall
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py", line 512 in __call__
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\config\__init__.py", line 175 in main
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\config\__init__.py", line 201 in console_main
  File "C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\pytest\__main__.py", line 9 in <module>
  File "<frozen runpy>", line 88 in _run_code
  File "<frozen runpy>", line 198 in _run_module_as_main
ERROR [ 20%]
tests/modules/dam/test_backend_gaps.py::test_album_crud ERROR            [ 40%]
tests/modules/dam/test_backend_gaps.py::test_graph_links_endpoint ERROR  [ 60%]
tests/modules/dam/test_backend_gaps.py::test_full_ai_pipeline_execution ERROR [ 80%]
tests/modules/dam/test_backend_gaps.py::test_search_graph_expansion ERROR [100%]

=================================== ERRORS ====================================
______________ ERROR at setup of test_ai_processors_registration ______________

    @pytest_asyncio.fixture(autouse=True)
    async def registry_setup():
        from src.modules.dam.hooks import hooks
        from src.core.services.settings_service import settings_service
        from src.modules.dam.settings import DAMSettings
    
        # Pre-register settings so hooks.register_services doesn't fail
        settings_service._cache["dam"] = DAMSettings(system_owner_id=str(TEST_OWNER_ID))
    
>       hooks.register_services()

tests\modules\dam\test_backend_gaps.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src\modules\dam\hooks.py:127: in register_services
    StructuralProcessor(),
    ^^^^^^^^^^^^^^^^^^^^^
src\modules\dam\processors\structural_processor.py:14: in __init__
    from torchvision import transforms
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\__init__.py:10: in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:163: in <module>
    @torch.library.register_fake("torchvision::nms")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\library.py:1023: in register
    use_lib._register_fake(op_name, func, _stacklevel=stacklevel + 1)
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\library.py:214: in _register_fake
    handle = entry.fake_impl.register(func_to_register, source)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <torch._library.fake_impl.FakeImplHolder object at 0x00000222966E9890>
func = <function meta_nms at 0x0000022296B536A0>
source = 'C:\\Users\\sanal\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\torchvision\\_meta_registrations.py:163'

    def register(self, func: Callable, source: str) -> RegistrationHandle:
        """Register an fake impl.
    
        Returns a RegistrationHandle that one can use to de-register this
        fake impl.
        """
        if self.kernel is not None:
            raise RuntimeError(
                f"register_fake(...): the operator {self.qualname} "
                f"already has an fake impl registered at "
                f"{self.kernel.source}."
            )
>       if torch._C._dispatch_has_kernel_for_dispatch_key(self.qualname, "Meta"):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       RuntimeError: operator torchvision::nms does not exist

C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\_library\fake_impl.py:31: RuntimeError
---------------------------- Captured stderr setup ----------------------------
2026-02-21 06:34:43.987 | WARNING  | src.modules.dam.drivers.video_driver:__init__:19 - VideoDriver: 'ffprobe' not found in system PATH. Video metadata extraction is disabled.
2026-02-21 06:34:43.987 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: ImageDriver for type 'image'
2026-02-21 06:34:43.987 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: VideoDriver for type 'video'
2026-02-21 06:34:43.987 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: AudioDriver for type 'audio'
2026-02-21 06:34:43.987 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: DocumentDriver for type 'document'
2026-02-21 06:34:43.987 | INFO     | src.modules.dam.hooks:register_services:104 - DAM: Registered AssetDriverManager containing 4 drivers.
______________________ ERROR at setup of test_album_crud ______________________

    @pytest_asyncio.fixture(autouse=True)
    async def registry_setup():
        from src.modules.dam.hooks import hooks
        from src.core.services.settings_service import settings_service
        from src.modules.dam.settings import DAMSettings
    
        # Pre-register settings so hooks.register_services doesn't fail
        settings_service._cache["dam"] = DAMSettings(system_owner_id=str(TEST_OWNER_ID))
    
>       hooks.register_services()

tests\modules\dam\test_backend_gaps.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src\modules\dam\hooks.py:127: in register_services
    StructuralProcessor(),
    ^^^^^^^^^^^^^^^^^^^^^
src\modules\dam\processors\structural_processor.py:14: in __init__
    from torchvision import transforms
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\__init__.py:10: in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:25: in <module>
    @register_meta("roi_align")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

fn = <function meta_roi_align at 0x0000022296B39A80>

    def wrapper(fn):
>       if torchvision.extension._has_ops():
           ^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)

C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:18: AttributeError
---------------------------- Captured stderr setup ----------------------------
2026-02-21 06:34:47.952 | WARNING  | src.modules.dam.drivers.video_driver:__init__:19 - VideoDriver: 'ffprobe' not found in system PATH. Video metadata extraction is disabled.
2026-02-21 06:34:47.952 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: ImageDriver for type 'image'
2026-02-21 06:34:47.952 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: VideoDriver for type 'video'
2026-02-21 06:34:47.953 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: AudioDriver for type 'audio'
2026-02-21 06:34:47.953 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: DocumentDriver for type 'document'
2026-02-21 06:34:47.953 | INFO     | src.modules.dam.hooks:register_services:104 - DAM: Registered AssetDriverManager containing 4 drivers.
_________________ ERROR at setup of test_graph_links_endpoint _________________

    @pytest_asyncio.fixture(autouse=True)
    async def registry_setup():
        from src.modules.dam.hooks import hooks
        from src.core.services.settings_service import settings_service
        from src.modules.dam.settings import DAMSettings
    
        # Pre-register settings so hooks.register_services doesn't fail
        settings_service._cache["dam"] = DAMSettings(system_owner_id=str(TEST_OWNER_ID))
    
>       hooks.register_services()

tests\modules\dam\test_backend_gaps.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src\modules\dam\hooks.py:127: in register_services
    StructuralProcessor(),
    ^^^^^^^^^^^^^^^^^^^^^
src\modules\dam\processors\structural_processor.py:14: in __init__
    from torchvision import transforms
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\__init__.py:10: in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:25: in <module>
    @register_meta("roi_align")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

fn = <function meta_roi_align at 0x0000022296B3AD40>

    def wrapper(fn):
>       if torchvision.extension._has_ops():
           ^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)

C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:18: AttributeError
---------------------------- Captured stderr setup ----------------------------
2026-02-21 06:34:48.310 | WARNING  | src.modules.dam.drivers.video_driver:__init__:19 - VideoDriver: 'ffprobe' not found in system PATH. Video metadata extraction is disabled.
2026-02-21 06:34:48.310 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: ImageDriver for type 'image'
2026-02-21 06:34:48.310 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: VideoDriver for type 'video'
2026-02-21 06:34:48.310 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: AudioDriver for type 'audio'
2026-02-21 06:34:48.310 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: DocumentDriver for type 'document'
2026-02-21 06:34:48.310 | INFO     | src.modules.dam.hooks:register_services:104 - DAM: Registered AssetDriverManager containing 4 drivers.
______________ ERROR at setup of test_full_ai_pipeline_execution ______________

    @pytest_asyncio.fixture(autouse=True)
    async def registry_setup():
        from src.modules.dam.hooks import hooks
        from src.core.services.settings_service import settings_service
        from src.modules.dam.settings import DAMSettings
    
        # Pre-register settings so hooks.register_services doesn't fail
        settings_service._cache["dam"] = DAMSettings(system_owner_id=str(TEST_OWNER_ID))
    
>       hooks.register_services()

tests\modules\dam\test_backend_gaps.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src\modules\dam\hooks.py:127: in register_services
    StructuralProcessor(),
    ^^^^^^^^^^^^^^^^^^^^^
src\modules\dam\processors\structural_processor.py:14: in __init__
    from torchvision import transforms
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\__init__.py:10: in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:25: in <module>
    @register_meta("roi_align")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

fn = <function meta_roi_align at 0x0000022296B3BCE0>

    def wrapper(fn):
>       if torchvision.extension._has_ops():
           ^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)

C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:18: AttributeError
---------------------------- Captured stderr setup ----------------------------
2026-02-21 06:34:48.664 | WARNING  | src.modules.dam.drivers.video_driver:__init__:19 - VideoDriver: 'ffprobe' not found in system PATH. Video metadata extraction is disabled.
2026-02-21 06:34:48.665 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: ImageDriver for type 'image'
2026-02-21 06:34:48.665 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: VideoDriver for type 'video'
2026-02-21 06:34:48.665 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: AudioDriver for type 'audio'
2026-02-21 06:34:48.666 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: DocumentDriver for type 'document'
2026-02-21 06:34:48.666 | INFO     | src.modules.dam.hooks:register_services:104 - DAM: Registered AssetDriverManager containing 4 drivers.
________________ ERROR at setup of test_search_graph_expansion ________________

    @pytest_asyncio.fixture(autouse=True)
    async def registry_setup():
        from src.modules.dam.hooks import hooks
        from src.core.services.settings_service import settings_service
        from src.modules.dam.settings import DAMSettings
    
        # Pre-register settings so hooks.register_services doesn't fail
        settings_service._cache["dam"] = DAMSettings(system_owner_id=str(TEST_OWNER_ID))
    
>       hooks.register_services()

tests\modules\dam\test_backend_gaps.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src\modules\dam\hooks.py:127: in register_services
    StructuralProcessor(),
    ^^^^^^^^^^^^^^^^^^^^^
src\modules\dam\processors\structural_processor.py:14: in __init__
    from torchvision import transforms
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\__init__.py:10: in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:25: in <module>
    @register_meta("roi_align")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

fn = <function meta_roi_align at 0x0000022296B94360>

    def wrapper(fn):
>       if torchvision.extension._has_ops():
           ^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)

C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\_meta_registrations.py:18: AttributeError
---------------------------- Captured stderr setup ----------------------------
2026-02-21 06:34:49.053 | WARNING  | src.modules.dam.drivers.video_driver:__init__:19 - VideoDriver: 'ffprobe' not found in system PATH. Video metadata extraction is disabled.
2026-02-21 06:34:49.053 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: ImageDriver for type 'image'
2026-02-21 06:34:49.053 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: VideoDriver for type 'video'
2026-02-21 06:34:49.053 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: AudioDriver for type 'audio'
2026-02-21 06:34:49.053 | DEBUG    | src.modules.dam.drivers.manager:register:21 - Registered Asset Driver: DocumentDriver for type 'document'
2026-02-21 06:34:49.053 | INFO     | src.modules.dam.hooks:register_services:104 - DAM: Registered AssetDriverManager containing 4 drivers.
============================== warnings summary ===============================
C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\formparsers.py:12
  C:\Users\sanal\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\formparsers.py:12: PendingDeprecationWarning: Please use `import python_multipart` instead.
    import multipart

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
ERROR tests/modules/dam/test_backend_gaps.py::test_ai_processors_registration - RuntimeError: operator torchvision::nms does not exist
ERROR tests/modules/dam/test_backend_gaps.py::test_album_crud - AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)
ERROR tests/modules/dam/test_backend_gaps.py::test_graph_links_endpoint - AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)
ERROR tests/modules/dam/test_backend_gaps.py::test_full_ai_pipeline_execution - AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)
ERROR tests/modules/dam/test_backend_gaps.py::test_search_graph_expansion - AttributeError: partially initialized module 'torchvision' has no attribute 'extension' (most likely due to a circular import)
======================== 1 warning, 5 errors in 9.76s =========================
